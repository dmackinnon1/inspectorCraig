---
title: "Tiger and Treasure Puzzles"
author: "Dan MacKinnon"
date: "March 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This document generates some of the diagrams used in a [blog post](http://www.mathrecreation.com/2018/03/tigers-and-treasure.html) about the tiger and treasure problems generated by this project.

First, reading in the puzzle descriptions:

```{r}
TigerTreasure <- read.csv('tiger_report.csv',stringsAsFactors=FALSE)
print(str(TigerTreasure))
```

The clues on the doors are from the set below.

```{r}
inscriptions <- read.csv('inscriptions.csv')
print(inscriptions)
```

## Which Puzzles are Free of Contradictions?

```{r}
door1 <- 1:14
door2 <- 1:14
#no solutions
HasSol  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(TigerTreasure[j,]$consistent == " true")
}
image(x=door1, y=door2, HasSol, col=grey.colors(2, start=1, end=0), main='puzzles with solutions')
```

## Which Puzzles are Free of Contradictions, but Cannot be Solved?

```{r}
NoKnowns  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  tcount <- TigerTreasure[j,]$tiger_count + TigerTreasure[j,]$treasure_count
  if ( HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] == 0) {
    tcount <- 1
  }
  NoKnowns[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(tcount == 0)
}  
image(x=door1, y=door2, NoKnowns, col=grey.colors(2, start=1, end=0), main='puzzles that lead nowhere')
```

## Which Puzzles have Two Tigers?

```{r}
Tigers2  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  tcount <- TigerTreasure[j,]$tiger_count 
  if ( HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] == 0) {
    tcount <- 0
  }
  Tigers2[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(tcount == 2)
}  
image(x=door1, y=door2, Tigers2, col=grey.colors(10, start=1, end=0),main='puzzles with two tigers')
```


## Which Puzles have Two Treasures?
```{r}
Treasures2  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  tcount <- TigerTreasure[j,]$treasure_count 
  if ( HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] == 0) {
    tcount <- 0
  }
  Treasures2[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(tcount == 2)
}  
image(x=door1, y=door2, Treasures2, col=grey.colors(2, start=1, end=0), main='puzzles with two treasures')
```

## Puzzles with both a Tiger and Treasure
```{r}
OneEach  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  treasure <- TigerTreasure[j,]$treasure_count 
  tigers <- TigerTreasure[j,]$tiger_count
  if ( HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] == 0) {
    treasure <- 0
    tigers <- 0
  }
  OneEach[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(treasure == 1 && tigers == 1)
}  
image(x=door1, y=door2, OneEach, col=grey.colors(2, start=1, end=0), main='puzzles with both tiger and treasure')
```

## Puzzles with one door left uknown
```{r}
OneUnknown  <- matrix(rep(0, 196), nrow=14, ncol=14)
for (j in 1:196){
  tcount <- TigerTreasure[j,]$treasure_count + TigerTreasure[j,]$tiger_count  
  if ( HasSol[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] == 0) {
    tcount <-0
  }
  OneUnknown[(TigerTreasure[j,]$door_1 + 1),(TigerTreasure[j,]$door_2 + 1)] <- as.numeric(tcount == 1)
}  
image(x=door1, y=door2, OneUnknown, col=grey.colors(2, start=1, end=0), main='one door uncertain')
```